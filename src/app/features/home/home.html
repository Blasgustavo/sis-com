<div class="flex">

  <!-- Mobile menu button -->  
  <div 
      id="btn-menu"
      type="button"
      (click)="toggleMenu()"
      class="inline-flex items-center text-primary
      p-2 mt-2 ml-3 text-sm fixed top-2 right-2
      rounded-lg sm:hidden hover:bg-base-100 hover:text-neutral-content"
    >
    <svg class="w-6 h-6" aria-hidden="true" fill="currentColor">
      <use href="assets/sprite.svg#icon-menu"></use>
    </svg>
  </div>
  <!-- Sidebar -->
  <aside 
  class="fixed top-0 left-0 z-40 w-64 h-screen bg-base-100 text-base-content border-r border-primary-content 
          transform -translate-x-full transition-transform duration-300 sm:translate-x-0" [class.-translate-x-full]="!isOpenMenu"
  >
    <div class="overflow-y-auto py-5 px-3 h-full">
        <ul class="space-y-2">
            <li>
                <p href="#" class="flex flex-col items-center text-base-content/90 rounded-lg group">
                <span class="ml-3 pb-4 text-primary text-2xl font-bold ">Sistema Comercial</span>
                <svg aria-hidden="true" class="w-20 h-20 " fill="currentColor">
                  <use href="assets/sprite.svg#icon-user"></use>
                </svg>
                <span class="ml-5">Bienvenido</span>
                <span class="ml-5">{{userName()}}</span>
                <span class="ml-5">({{userRole()}})</span>
              </p>
            </li>
            <li>
              <button type="button" 
                (click)="tdInicio()" 
                class="flex items-center p-2 w-full text-base-content 
                    rounded-lg transition duration-75 group hover:bg-base-200 hover:text-primary">
                  <svg aria-hidden="true" class="w-6 h-6 transition duration-75 " fill="currentColor">
                    <use href="assets/sprite.svg#icon-home"></use>
                  </svg>
                  <span class="flex-1 ml-3 text-left whitespace-nowrap">Inicio</span>
                  <svg aria-hidden="true" class="w-6 h-6 transition-transform duration-300"
                    [class.rotate-180]="isTdinicio"
                    fill="currentColor">
                    <use href="assets/sprite.svg#icon-arrow-down"></use>
                  </svg>
              </button>

              <ul 
                class="overflow-hidden transition-all duration-300 p-0 space-y-2"
                [style.maxHeight]="isTdinicio ? '500px' : '0px'"
              >
                <li>
                  <button (click)="goHomepage()" class="flex items-center p-2 pl-11 w-full text-base-content font-normal rounded-lg transition duration-75 group hover:bg-base-200 hover:text-primary">
                    Resumen General
                  </button>
                </li>
                <li>
                  <button (click)="goUpdate()" class="flex items-center p-2 pl-11 w-full text-base-content font-normal rounded-lg transition duration-75 group hover:bg-base-200 hover:text-primary">
                    Últimas Actualizaciones
                  </button>
                </li>
              </ul>
            </li>
            <li>
                <button type="button" 
                  (click)="tdProgramacion()" 
                  class="flex items-center p-2 w-full text-base-content 
                    rounded-lg transition duration-75 group hover:bg-base-200 hover:text-primary">
                    <svg aria-hidden="true" class=" w-6 h-6 transition duration-75" fill="currentColor">
                      <use href="assets/sprite.svg#icon-document"></use>  
                    </svg>
                    <span class="flex-1 ml-3 text-left whitespace-nowrap">Programacion</span>
                    <svg aria-hidden="true" class="w-6 h-6 transition-transform duration-300"
                      [class.rotate-180]="isTdprogramacion" fill="currentColor">
                      <use href="assets/sprite.svg#icon-arrow-down"></use>
                    </svg>
                </button>
              <ul 
                class="overflow-hidden transition-all duration-300 p-0 space-y-2"
                [style.maxHeight]="isTdprogramacion ? '500px' : '0px'"
              >
                <li>
                  <button (click)="goTaskpage()" class="flex items-center p-2 pl-11 w-full text-base-content font-normal rounded-lg transition duration-75 group hover:bg-base-200 hover:text-primary">
                    Subir tareo
                  </button>
                </li>
                <li>
                  <button (click)="goMonitoring()" class="flex items-center p-2 pl-11 w-full text-base-content font-normal rounded-lg transition duration-75 group hover:bg-base-200 hover:text-primary">
                    Mapa de monitoreo
                  </button>
                </li>
                <li>
                  <button (click)="goHistory()" class="flex items-center p-2 pl-11 w-full text-base-content font-normal rounded-lg transition duration-75 group hover:bg-base-200 hover:text-primary">
                    Historial de tareo
                  </button>
                </li>
              </ul>
            </li>
            <li>
              <button type="button" 
                  (click)="tdReportes()" 
                  class="flex items-center p-2 w-full text-base-content 
                    rounded-lg transition duration-75 group hover:bg-base-200 hover:text-primary">
                    <svg aria-hidden="true" class=" w-6 h-6 transition duration-75"fill="currentColor">
                    <use href="assets/sprite.svg#icon-report"></use>  
                    </svg>
                    <span class="flex-1 ml-3 text-left whitespace-nowrap">Reportes</span>
                    <svg aria-hidden="true" class="w-6 h-6 transition-transform duration-300"
                      [class.rotate-180]="isTdreportes"
                      fill="currentColor">
                      <use href="assets/sprite.svg#icon-arrow-down"></use>
                    </svg>
                </button>
                <ul 
                  class="overflow-hidden transition-all duration-300 p-0 space-y-2"
                  [style.maxHeight]="isTdreportes ? '500px' : '0px'"
                >
                  <li>
                    <button 
                      (click)="goReportspage()" 
                      class="flex items-center p-2 pl-11 w-full text-base-content font-normal rounded-lg transition duration-75 group hover:bg-base-200 hover:text-primary">
                      Estado de ejecusión
                    </button>
                  </li>
                  <li>
                    <button 
                      (click)="goExportspage()" 
                      class="flex items-center p-2 pl-11 w-full text-base-content font-normal rounded-lg transition duration-75 group hover:bg-base-200 hover:text-primary">
                      Exportar datos
                    </button>
                  </li>
                </ul>
            </li>
            <li>
              <button type="button" 
                  (click)="tdPerfil()" 
                  class="flex items-center p-2 w-full text-base-content 
                    rounded-lg transition duration-75 group hover:bg-base-200 hover:text-primary">
                    <svg aria-hidden="true" class=" w-6 h-6 
                    transition duration-75" fill="currentColor">
                    <use href="assets/sprite.svg#icon-user"></use>  
                    </svg>
                    <span class="flex-1 ml-3 text-left whitespace-nowrap">Perfil</span>
                    <svg aria-hidden="true" class="w-6 h-6 transition-transform duration-300"
                      [class.rotate-180]="isTdperfil"
                      fill="currentColor">
                      <use href="assets/sprite.svg#icon-arrow-down"></use>
                    </svg>
                </button>
                <ul 
                  class="overflow-hidden transition-all duration-300 p-0 space-y-2"
                  [style.maxHeight]="isTdperfil ? '500px' : '0px'"
                >
                  <li>
                    <button 
                      (click)="goPerfilpage()" 
                      class="flex items-center p-2 pl-11 w-full text-base-content font-normal rounded-lg transition duration-75 group hover:bg-base-200 hover:text-primary">
                      Datos personales
                    </button>
                  </li>

                  <li>
                    <button 
                      (click)="goUpdateuser()" 
                      class="flex items-center p-2 pl-11 w-full text-base-content font-normal rounded-lg transition duration-75 group hover:bg-base-200 hover:text-primary">
                      Cambiar contraseña
                    </button>
                  </li>
                </ul>
            </li>
        </ul>
        <ul class="pt-5 mt-5 space-y-2 border-t border-gray-200 dark:border-gray-700">
          <li>
              <button type="button" 
                  (click)="tdAyuda()" 
                  class="flex items-center p-2 w-full text-base-content 
                    rounded-lg transition duration-75 group hover:bg-base-200 hover:text-primary">
                    <svg aria-hidden="true" class=" w-6 h-6 transition duration-75" fill="currentColor">
                    <use href="assets/sprite.svg#icon-help"></use>  
                    </svg>
                    <span class="flex-1 ml-3 text-left whitespace-nowrap">Ayuda</span>
                    <svg aria-hidden="true" class="w-6 h-6 transition-transform duration-300"
                      [class.rotate-180]="isTdAyuda"
                      fill="currentColor">
                      <use href="assets/sprite.svg#icon-arrow-down"></use>
                    </svg>
                </button>
                <ul 
                  class="overflow-hidden transition-all duration-300 p-0 space-y-2"
                  [style.maxHeight]="isTdAyuda ? '500px' : '0px'"
                >
                        <li>
                          <a href="#" class="flex items-center p-2 pl-11 w-full text-base-content font-normal  rounded-lg transition duration-75 group hover:bg-base-200 hover:text-primary">Preguntas frecuentes</a>
                        </li>
                        <li>
                          <a href="#" class="flex items-center p-2 pl-11 w-full text-base-content font-normal  rounded-lg transition duration-75 group hover:bg-base-200 hover:text-primary">Contacto Soporte</a>
                        </li>
                      </ul>
                    </li>
                    <li>
                      <button type="button" 
                      (click)="tdConfi()" 
                      class="flex items-center p-2 w-full text-base-content 
                      rounded-lg transition duration-75 group hover:bg-base-200 hover:text-primary">
                      <svg aria-hidden="true" class=" w-6 h-6 transition duration-75" fill="currentColor">
                        <use href="assets/sprite.svg#icon-config"></use>  
                      </svg>
                      
                      <span class="flex-1 ml-3 text-left whitespace-nowrap">Configuración</span>
                      <svg aria-hidden="true" class="w-6 h-6 transition-transform duration-300"
                      [class.rotate-180]="isTdconfi"
                      fill="currentColor">
                      <use href="assets/sprite.svg#icon-arrow-down"></use>
                    </svg>
                  </button>
                  <ul 
                  class="overflow-hidden transition-all duration-300 p-0 space-y-2"
                  [style.maxHeight]="isTdconfi ? '500px' : '0px'"
                  >
                    <li>
                      <button 
                        (click)="goListUser()" 
                        class="flex items-center p-2 pl-11 w-full text-base-content font-normal rounded-lg transition duration-75 group hover:bg-base-200 hover:text-primary">
                          Usuarios
                      </button>
                    </li>
                </ul>
                <ul 
                  class="overflow-hidden transition-all duration-300 p-0 space-y-2"
                  [style.maxHeight]="isTdconfi ? '500px' : '0px'"
                  >
                    <li>
                      <button 
                        (click)="goGestionUser()" 
                        class="flex items-center p-2 pl-11 w-full text-base-content font-normal rounded-lg transition duration-75 group hover:bg-base-200 hover:text-primary">
                          Gestion de Usuarios
                      </button>
                    </li>
                </ul>
            </li>

        </ul>
    </div>
    <div class="absolute bottom-0 w-64 mb-2 px-4">
      <div class="flex items-center justify-between gap-4">

        <!-- Toggle -->
        <label class="flex items-center cursor-pointer gap-3">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round">
            <circle cx="12" cy="12" r="5" />
            <path
              d="M12 1v2M12 21v2M4.2 4.2l1.4 1.4M18.4 18.4l1.4 1.4M1 12h2M21 12h2M4.2 19.8l1.4-1.4M18.4 5.6l1.4-1.4" />
          </svg>

          <input
            type="checkbox"
            class="toggle"
            aria-label="Toggle theme"
            [checked]="theme() === 'dark'"
            (change)="toggleTheme($event.target.checked)"
          />

          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
          </svg>
        </label>

        <!-- Botón logout compacto -->
        <button class="btn btn-xs btn-primary" (click)="logout()">
          Cerrar Sesion
        </button>

      </div>
    </div>

  </aside>
  <main class="flex-1 sm:ml-64"> 
    <router-outlet></router-outlet>
  </main>
</div>
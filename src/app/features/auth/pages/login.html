<div class="flex items-center justify-center h-screen">
  <div class="shadow-sm card w-96 bg-base-100">
    <div class="card-body">

      <h2 class="text-3xl font-bold text-center">Iniciar Sesión</h2>
      <p class="text-sm text-center text-gray-600">
        Ingrese sus datos. Tiene 3 intentos antes de que el usuario se bloquee.
      </p>

      @if (auth.errorMessage()) {
        <p class="mt-2 font-semibold text-center text-red-500">
          {{ auth.errorMessage() }}
        </p>
      }

      <form #f="ngForm" (ngSubmit)="onLogin()">

        <!-- Usuario -->
        <div class="flex flex-col">
          <span class="block mb-2 text-base font-medium text-gray-700">Usuario:</span>

          <label
            class="flex items-center w-full gap-2 rounded-sm input input-bordered"
            [ngClass]="{
              'input-primary': userCtrl.valid || !userCtrl.touched,
              'input-error': userCtrl.invalid && userCtrl.touched
            }"
          >
            <svg class="h-[1em] opacity-50" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
              <g stroke-linejoin="round" stroke-linecap="round" stroke-width="2.5" fill="none" stroke="currentColor">
                <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"></path>
                <circle cx="12" cy="7" r="4"></circle>
              </g>
            </svg>

            <input
              type="text"
              name="user"
              [(ngModel)]="user"
              #userCtrl="ngModel"
              placeholder="Usuario"
              required
              minlength="3"
              maxlength="30"
              class="grow"
            />
          </label>

          @if (userCtrl.invalid && userCtrl.touched) {
            <p class="mt-1 text-sm text-red-500">
              @if (userCtrl.errors?.['required']) {
                El usuario es obligatorio.
              }
              @if (userCtrl.errors?.['minlength']) {
                Debe tener al menos 3 caracteres.
              }
              @if (userCtrl.errors?.['maxlength']) {
                Máximo 30 caracteres permitidos.
              }
            </p>
          }
        </div>

        <!-- Contraseña -->
        <div class="mt-4">
          <span class="block mb-2 text-base font-medium text-gray-700">Contraseña:</span>

          <label
            class="flex items-center w-full gap-2 rounded-sm input input-bordered"
            [ngClass]="{
              'input-primary': passCtrl.valid || !passCtrl.touched,
              'input-error': passCtrl.invalid && passCtrl.touched
            }"
          >
            <svg class="h-[1em] opacity-50" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
              <g stroke-linejoin="round" stroke-linecap="round" stroke-width="2.5" fill="none" stroke="currentColor">
                <path d="M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z"></path>
                <circle cx="16.5" cy="7.5" r=".5" fill="currentColor"></circle>
              </g>
            </svg>

            <input
              type="password"
              name="password"
              [(ngModel)]="password"
              #passCtrl="ngModel"
              placeholder="Contraseña"
              required
              minlength="4"
              class="grow"
            />
          </label>

          @if (passCtrl.invalid && passCtrl.touched) {
            <p class="mt-1 text-sm text-red-500">
              @if (passCtrl.errors?.['required']) {
                La contraseña es obligatoria.
              }
              @if (passCtrl.errors?.['minlength']) {
                Debe tener al menos 4 caracteres.
              }
            </p>
          }
        </div>

        <!-- Recordar datos -->
        <div class="flex justify-center m-5">
          <label class="flex items-center gap-3">
            <span>Recordar Datos</span>
            <input 
              type="checkbox" 
              class="checkbox checkbox-success"
              [(ngModel)]="remember"
              name="remember"
            />
          </label>
        </div>

        <!-- Botón ingresar -->
        <div class="mb-5">
          <button 
            type="submit" 
            class="w-full rounded-sm btn btn-primary"
            [disabled]="f.invalid || auth.isLoading()"
          >
            @if (!auth.isLoading()) {
              <span>INGRESAR</span>
            } @else {
              <span>Procesando...</span>
            }
          </button>
        </div>

        <!-- Botón limpiar -->
        <div>
          <button class="w-full rounded-sm btn btn-ghost" type="reset">
            Limpiar datos ingresados
          </button>
        </div>

      </form>
    </div>
  </div>
</div>
